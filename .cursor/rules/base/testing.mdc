---
description: Common testing philosophy and patterns for all test types
alwaysApply: false
---
# Testing Rules

## Philosophy
**CRITICAL**: All tests use real APIs with real API keys. NO MOCKS for core functionality.

- E2E tests hit real endpoints (no unit tests)
- Integration tests use real external services
- Validate against OpenAPI schemas
- Use actual credentials from env vars

**Exception**: UI-only tests (rendering/styling) may mock APIs for performance.

## TDD
**Optional and agent-discretionary** - use when appropriate, not mandatory unless user requests.

**When beneficial**: Complex logic, critical paths (auth/payments), refactoring, API contracts.

**Workflow**: Red (failing test) → Green (minimal pass) → Refactor → Repeat

**Note**: If user requests TDD, use @.cursor/commands/tdd.md

## Coverage Requirements

**Endpoints (API only, never unit test):**
- CRUD operations, error handling, response validation, auth, input validation

**Components:**
- Rendering, user interactions, API integration, error handling, loading states

## Mocking
**Mock**: UI-only tests, window APIs (`window`, `localStorage`), timers

**Never mock**: API calls, external services, authentication, data fetching hooks

## Related
- @.cursor/rules/backend/testing.mdc - Fastify patterns
- @.cursor/rules/frontend/testing.mdc - React/Next.js patterns
