---
description: Solidity development standards with Foundry
globs: **/contracts/**/*.sol,*.sol
alwaysApply: false
---
# Solidity & Foundry Rules

## Core Principles
- Use latest stable Solidity version (^0.8.20)
- Use custom errors instead of revert strings

## Contract Structure
```solidity
// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

import {Ownable} from "@openzeppelin/contracts/access/Ownable.sol";
import {ReentrancyGuard} from "@openzeppelin/contracts/security/ReentrancyGuard.sol";

error Unauthorized();
error InvalidAmount();

contract ExampleContract is Ownable, ReentrancyGuard {
    // Events
    event Deposited(address indexed user, uint256 amount);
    
    // State variables
    uint256 public constant MIN_DEPOSIT = 0.1 ether;
    mapping(address => uint256) public balances;
    
    // Functions
    function deposit() external payable nonReentrant {
        // Checks
        if (msg.value < MIN_DEPOSIT) revert InvalidAmount();
        
        // Effects
        balances[msg.sender] += msg.value;
        
        // Interactions
        emit Deposited(msg.sender, msg.value);
    }
}
```

## Gas Optimization
- Use unchecked blocks for safe math operations
- Pack storage variables efficiently
- Cache storage variables in memory

```solidity
contract GasOptimized {
    // Pack related variables
    struct UserInfo {
        uint96 balance;
        uint96 stakedAmount;
        uint64 lastUpdate;
    }
}
```