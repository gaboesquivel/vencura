---
title: "Solana Contracts (Anchor)"
description: "Set up Anchor for Solana smart contract development with Rust."
---

This guide covers setting up Anchor for Solana smart contract development in the monorepo.

## Overview

Solana programs are located in `contracts/solana/` and use Anchor framework for development, testing, and deployment. Anchor is optional - if not installed, builds skip gracefully without failing the pipeline.

## Monorepo Integration

This package is fully integrated into the monorepo workspace:

- **Package**: `@repo/contracts-solana`
- **Workspace**: Included in `pnpm-workspace.yaml` as `contracts/*`
- **Scripts**: Run via `pnpm --filter @repo/contracts-solana` pattern
- **Caching**: Turborepo caches builds when tools are available
- **Graceful degradation**: Builds skip if Anchor not installed (no CI failures)

For comprehensive usage, deployment examples, and anchor commands, see the `contracts/solana/README.md` file in the repository.

## Quick Setup

Install Anchor:

```bash
pnpm setup:solana
```

Or install everything (including security tools and EVM):

```bash
pnpm setup
```

## Prerequisites

- Node.js >= 22
- Rust (required for Anchor on Linux)
- Solana CLI
- Anchor Version Manager (avm)

## Installation

### macOS

**Via Homebrew (recommended):**
```bash
brew install anchor-lang/anchor/anchor
```

**Via avm:**
```bash
avm install latest
avm use latest
```

### Linux

**Install Rust first (if not installed):**
```bash
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
source $HOME/.cargo/env
```

**Install avm and Anchor:**
```bash
cargo install --git https://github.com/coral-xyz/anchor avm --locked --force
avm install latest
avm use latest
```

### Windows

**Recommended: Use WSL or avm**

The official recommendation for Windows is to use WSL (Windows Subsystem for Linux) and follow the Linux installation steps, or use avm (Anchor Version Manager) if available.

**Alternative options (community-maintained):**

**Via Chocolatey (community-maintained):**
```bash
choco install anchor
```

**Via Scoop (not officially supported):**
```bash
scoop install anchor
```

Note: The Chocolatey package is community-maintained and Scoop is not an officially supported/confirmed source for Anchor. For the most reliable installation, use WSL with the Linux instructions above.

## Verify Installation

```bash
anchor --version
solana --version
```

## Automated Setup

Use the setup script:

```bash
pnpm setup:solana
```

This script:
- Checks if Anchor is already installed
- Installs via Homebrew (macOS) or avm/cargo (Linux)
- Checks for Rust/Cargo dependency on Linux
- Provides installation instructions if automatic installation fails

## Project Structure

```
contracts/solana/
├── programs/         # Solana program source files
├── tests/            # TypeScript test files
├── scripts/          # Deployment scripts
├── Anchor.toml       # Anchor configuration
├── Cargo.toml        # Workspace Cargo configuration
└── package.json      # Package scripts
```

## Usage

### Build Programs

```bash
pnpm --filter @repo/contracts-solana build
# or
cd contracts/solana && anchor build
```

### Run Tests

```bash
pnpm --filter @repo/contracts-solana test
# or
cd contracts/solana && anchor test
```

### Run Tests Without Local Validator

```bash
pnpm --filter @repo/contracts-solana test:local
# or
cd contracts/solana && anchor test --skip-local-validator
```

### Deploy Programs

**To localnet:**
```bash
pnpm --filter @repo/contracts-solana deploy:local
# or
cd contracts/solana && anchor deploy
```

**To devnet:**
```bash
pnpm --filter @repo/contracts-solana deploy:devnet
# or
cd contracts/solana && anchor deploy --provider.cluster devnet
```

**To testnet:**
```bash
pnpm --filter @repo/contracts-solana deploy:testnet
# or
cd contracts/solana && anchor deploy --provider.cluster testnet
```

## Build Pipeline Integration

Anchor builds are integrated into the monorepo build pipeline:

- **Build scripts check for tools**: If Anchor isn't installed, builds skip with a message
- **No pipeline failures**: Missing Anchor doesn't cause build failures (tool is optional)
- **Turbo caching**: Program builds are cached by Turbo when Anchor is available

### Build Behavior

When Anchor is missing:
```bash
# Build output
Anchor not installed, skipping Solana contract build
```

When Anchor is installed:
```bash
# Normal build output
anchor build
```

## Package Scripts

The `@repo/contracts-solana` package supports standard monorepo scripts:

```bash
# Build
pnpm --filter @repo/contracts-solana build

# Test
pnpm --filter @repo/contracts-solana test

# Deploy
pnpm --filter @repo/contracts-solana deploy:local
pnpm --filter @repo/contracts-solana deploy:devnet
pnpm --filter @repo/contracts-solana deploy:testnet
```

## Troubleshooting

### Anchor Not Found After Installation

After installing Anchor via avm, ensure avm is in your PATH:

```bash
# Add to ~/.bashrc or ~/.zshrc
export PATH="$HOME/.avm/bin:$PATH"
source $HOME/.bashrc  # or .zshrc
```

### Rust Not Installed (Linux)

Anchor on Linux requires Rust. Install it first:

```bash
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
source $HOME/.cargo/env
```

### Solana CLI Not Found

Install Solana CLI separately:

**macOS/Linux:**
```bash
sh -c "$(curl -sSfL https://release.solana.com/stable/install)"
```

**Windows:**
```bash
# Via Chocolatey
choco install solana
```

## Related Documentation

- [EVM Contracts](/docs/blockchain/evm-contracts) - Foundry and Solidity development
- [Monorepo Structure](/docs/core-concepts/monorepo-structure) - Package organization
- [Getting Started](/docs/getting-started) - Initial setup
