---
title: "ADR 005: Package Manager Selection"
description: "We need to select a package manager for our monorepo that works reliably with workspace dependencies, supports Next.js and NestJS, and provides good performance."
---

# ADR 005: Package Manager Selection

## Context

We need to select a package manager for our monorepo that:

- Works reliably with workspace dependencies
- Supports Next.js, NestJS, and Turbo monorepo setup
- Handles complex dependency resolution (e.g., `@tailwindcss/postcss` in workspace packages)
- Provides good performance and developer experience
- Is production-ready and well-supported

## Considered Options

### Option A – pnpm

Mature, workspace-optimized package manager.

**Pros**

- Correctly hoists and resolves dependencies across workspace packages
- Handles complex scenarios like `@tailwindcss/postcss` in `@workspace/ui` being accessible to `apps/web`
- Uses symlinks and proper node_modules structure for workspace packages
- Well-tested with Next.js, NestJS, and Turbo
- Mature support for monorepo patterns
- Extensive community adoption and documentation
- Battle-tested in production environments
- Reliable builds without workarounds
- Better tooling support (debugging, monitoring, CI/CD)
- No module resolution issues during builds
- Consistent behavior across development and production

**Cons**

- Slightly slower than Bun for package installation (acceptable trade-off)
- Not using Bun's runtime features (but we can use Node.js for runtime, Bun for scripts if needed)

### Option B – Bun

Fast, all-in-one runtime and package manager.

**Pros**

- Very fast package installation
- All-in-one runtime and package manager
- Modern tooling

**Cons**

- Encountered build failures with `Cannot find module '@tailwindcss/postcss'`
- Different workspace dependency resolution compared to pnpm
- Requires workarounds (e.g., duplicating dependencies) that add maintenance burden
- Newer workspace implementation with edge cases
- Less ecosystem testing for complex monorepo setups
- Potential for future compatibility issues
- Issues with Next.js builds in monorepo context
- Module resolution problems that don't occur with pnpm

## Decision

We will use **pnpm** as our package manager.

**Main reasons:**

- Correctly hoists and resolves dependencies across workspace packages (handles complex scenarios like `@tailwindcss/postcss`)
- Well-tested with Next.js, NestJS, and Turbo with mature support for monorepo patterns
- Battle-tested in production with reliable builds and no module resolution issues
- Extensive community adoption and documentation with better tooling support

## Notes

- Bun may be reconsidered in the future as workspace support matures
- For runtime, we use Node.js (especially for NestJS + WebSockets compatibility)
- Bun can still be used for scripts or other tooling if beneficial
